Used Car Data Project

Database Table Design

1. Daily\_sink

The BS4 python file will scrap the source data from page 1 to 15 and convert it to a parquet file. The parquet file will be stored in ADLS. The parquet file will be written into the daily\_sink table without any change using pandas.

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| listing\_id | varchar(20) |  |
| car\_model | varchar(80) | (Myvi, City, Vios) |
| price | varchar(80) | Price in RM |
| installment | varchar(80) | Price in RM/month |
| year | int | Manufacturing year |
| mileage | varchar(80) |  |
| color | varchar(80) |  |
| location | varchar(80) |  |
| state | varchar(80) |  |
| url | varchar(80) | Web Page url |
| image | nvarchar(max) | Array of image link |
| extracted\_date | datetime |  |

2. Staging\_table

The staging\_table data will be written using daily\_sink data. The daily\_sink data will be compared with the recent\_listings to check if the specific listing\_id (primary key) have been processed or not to avoid duplicates. 

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| listing\_id | varchar(20) |  |
| car\_model | varchar(80) | (Myvi, City, Vios) |
| price | numeric(18,0) | Price in RM |
| installment | numeric(18,0) | Price in RM/month |
| year | int | Manufacturing year |
| mileage | numeric(18,0) |  |
| color | varchar(80) |  |
| location | varchar(80) |  |
| state | varchar(80) |  |
| url | varchar(80) | Web Page url |
| image | nvarchar(max) | Array of image link |
| extracted\_date | datetime |  |
| processing\_date | datetime |  |

3. Prod\_table

The staging\_table will undergo transformations and quality checks before being written into the prod\_table. This prod\_table will serve the analytics layers and dashboard. 

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| listing\_id | varchar(20) | Primary key  |
| dim\_car\_model | varchar(20) | (Myvi, City, Vios) |
| fct\_price | numeric(18,0) | Price in RM |
| fct\_installment | numeric(18,0) | Price in RM/month |
| fct\_year | int | Manufacturing year |
| fct\_mileage | numeric(18,0) |  |
| dim\_color | varchar(20) |  |
| dim\_location | varchar(80) |  |
| dim\_state | varchar(20) |  |
| url | varchar(80) | Web Page url |
| dim\_extracted\_date | datetime | Primary key  |
| dim\_processing\_date | datetime |  |

4. Listing\_images

Normalization of images url of each of the listings. This table has no use for analytics level for now and will only serves the frontend API (not yet implemented)

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| listing\_id | varchar(20) | Primary key  |
| image\_url | nvarchar(255) | Url of image |

5. Recent\_listings

All listing\_id columns of processed daily\_sink data will be written here and be stored for 7 days. The record will be used to cross check with daily\_sink to avoid duplicates

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| listing\_id | varchar(20) |  |
| car\_model | varchar(80) | (Myvi, City, Vios) |
| price | varchar(80) | Price in RM |
| extracted\_date | date |  |

6. Trademark\_table

This table will track the transformation of the staging\_table status 

| Column Name | Data Type | Remark |
| :---- | :---- | :---- |
| batch\_id | varchar(20) | Generated by the pipeline code |
| processed\_time | datetime |  |
| status | varchar(20) | Success, failed, pending |
| row\_count | numeric(18,0) |  |

